create database sql_db_2
use sql_db_2

CREATE TABLE DEPT (
    deptno INT PRIMARY KEY,
    dname VARCHAR(50),
    loc VARCHAR(50)
);

CREATE TABLE EMP (
    empno INT PRIMARY KEY,
    ename VARCHAR(50),
    job VARCHAR(50),
    mgr_id INT,
    hiredate DATE,
    sal DECIMAL(10, 2),
    comm DECIMAL(10, 2),
    deptno INT,
    FOREIGN KEY (deptno) REFERENCES DEPT(deptno)
);


INSERT INTO DEPT (deptno, dname, loc) VALUES
(10, 'ACCOUNTING', 'NEW YORK'),
(20, 'RESEARCH', 'DALLAS'),
(30, 'SALES', 'CHICAGO'),
(40, 'OPERATIONS', 'BOSTON');

INSERT INTO EMP (empno, ename, job, mgr_id, hiredate, sal, comm, deptno) VALUES
(7369, 'SMITH', 'CLERK', 7902, '1980-12-17', 800, 0, 20),
(7499, 'ALLEN', 'SALESMAN', 7698, '1981-02-20', 1600, 300, 30),
(7521, 'WARD', 'SALESMAN', 7698, '1981-02-22', 1250, 500, 30),
(7566, 'JONES', 'MANAGER', 7839, '1981-04-02', 2975, 0, 20),
(7654, 'MARTIN', 'SALESMAN', 7698, '1981-09-28', 1250, 1400, 30),
(7698, 'BLAKE', 'MANAGER', 7839, '1981-05-01', 2850, 0, 30),
(7782, 'CLARK', 'MANAGER', 7839, '1981-06-09', 2450, 0, 10),
(7788, 'SCOTT', 'ANALYST', 7566, '1987-04-19', 3000, 0, 20),
(7839, 'KING', 'PRESIDENT', NULL, '1981-11-17', 5000, 0, 10),
(7844, 'TURNER', 'SALESMAN', 7698, '1981-09-08', 1500, 0, 30),
(7876, 'ADAMS', 'CLERK', 7788, '1987-05-23', 1100, 0, 20),
(7900, 'JAMES', 'CLERK', 7698, '1981-12-03', 950, 0, 30),
(7902, 'FORD', 'ANALYST', 7566, '1981-12-03', 3000, 0, 20),
(7934, 'MILLER', 'CLERK', 7782, '1982-01-23', 1300, 0, 10);

--Ques 1
SELECT *
FROM EMP
WHERE ENAME LIKE 'A%';

--Ques 2
SELECT *
FROM EMP
WHERE MGR_ID IS NULL;

--Ques 3
SELECT ENAME, EMPNO, SAL
FROM EMP
WHERE SAL BETWEEN 1200 AND 1400;

--Ques 4
SELECT *
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'RESEARCH');

UPDATE EMP
SET SAL = SAL * 1.1
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'RESEARCH');

SELECT *
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'RESEARCH');


--Ques 5
SELECT COUNT(*) AS Number_of_Clerks
FROM EMP
WHERE JOB = 'CLERK';

--Ques 6
SELECT JOB, AVG(SAL) AS Average_Salary, COUNT(*) AS Number_of_Employees
FROM EMP
GROUP BY JOB;

--Ques 7
SELECT *
FROM EMP
WHERE SAL = (SELECT MIN(SAL) FROM EMP)
   OR SAL = (SELECT MAX(SAL) FROM EMP);

--Ques 8
SELECT *
FROM DEPT
WHERE DEPTNO NOT IN (SELECT DISTINCT DEPTNO FROM EMP);

--Ques 9
SELECT ENAME, SAL
FROM EMP
WHERE JOB = 'ANALYST' AND SAL > 1200 AND DEPTNO = 20
ORDER BY ENAME ASC;


--Ques 10
SELECT D.DEPTNO, D.DNAME, SUM(E.SAL) AS Total_Salary
FROM DEPT D
LEFT JOIN EMP E ON D.DEPTNO = E.DEPTNO
GROUP BY D.DEPTNO, D.DNAME;

--Ques 11
SELECT ENAME, SAL
FROM EMP
WHERE ENAME IN ('MILLER', 'SMITH');

--Ques 12
SELECT *
FROM EMP
WHERE ENAME LIKE 'A%' OR ENAME LIKE 'M%';

--Ques 13
SELECT ENAME, SAL * 12 AS Yearly_Salary
FROM EMP
WHERE ENAME = 'SMITH';

--Ques 14
SELECT ENAME, SAL
FROM EMP
WHERE SAL NOT BETWEEN 1500 AND 2850;

--Ques 15
SELECT M.EMPNO, M.ENAME
FROM EMP M
JOIN EMP E ON M.EMPNO = E.MGR_ID
GROUP BY M.EMPNO, M.ENAME
HAVING COUNT(E.EMPNO) > 2;
